<!DOCTYPE html>

<html>
<head>
  <title>Getting Started With the Solpeo Framework</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>Getting Started With the Solpeo Framework</h1>
<p>To show you how to create a game with the Solpeo Framework, we&#39;ll show you how to create a Pong game.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>-</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Firstly, it makes sense to wrap your game code in an <code>Engine.ready</code> handler, to make sure that everything that needs
to be loaded has in fact loaded before you game logic is interpreted.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Engine.ready(<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>In our quick example game, we would like to have a couple of options. So let&#39;s go ahead and define them. Firstly, you
can choose between mouse and keyboard control, so we need to define the options first.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> controlOptions = {
        KEYBOARD: <span class="string">'keyboard'</span>,
        MOUSE: <span class="string">'mouse'</span>
    };

    <span class="keyword">var</span> settings = {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>In Pong there is a top and bottom bar which define the top and bottom of the playing field. Let&#39;s make these 20px wide
and define that in the settings. Similarly, we&#39;ll define how large several other elements need to be.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        barSize: <span class="number">20</span>,
        margin: <span class="number">40</span>,
        paddleHeight: <span class="number">80</span>,
        ballSize: <span class="number">20</span>,
        color: <span class="string">'white'</span>,
        stroke: <span class="string">'transparent'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>In the Pong game, both the ball and the paddles will need to be able to move. Let&#39;s define some variables here which
will allow us to fine-tune the movement later.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        ballSpeed: <span class="number">300</span>,
        paddleSpeed: <span class="number">100</span>,
        minPaddleSpeed: <span class="number">5</span>,
        maxPaddleSpeed: <span class="number">15</span>,
        playerElasticity: <span class="number">0.5</span>,
        aiElasticity: <span class="number">0.2</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Finally, we&#39;ll define some settings for the controls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        multiplayer: <span class="literal">false</span>,
        controls: {
            type: controlOptions.MOUSE,</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Keyboard assignments are defined for when you would like to use keyboard for controls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            leftUp: <span class="string">'W'</span>,
            leftDown: <span class="string">'S'</span>,
            rightUp: <span class="string">'ARROW_UP'</span>,
            rightDown: <span class="string">'ARROW_DOWN'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>We&#39;ll use mouseY to store the current position of the mouse cursor when mouse controls are used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            mouseY: <span class="number">0</span>
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>Essentials</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>-</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>The core of any game written using the Solpeo Engine is the <code>scene</code> object. It holds all elements which need to be
drawn onto the screen. Furthermore, other elements which have an in-game &#39;location&#39; may also be placed on the scene,
for example sounds which are location-bound (like the sound a waterfall makes).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> scene = <span class="keyword">new</span> Engine.Scene();</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>To tell the Engine where to display the scene, a viewport is needed. A viewport is simply an area on the screen (usually
a <code>div</code> element) where the Engine should draw something. The scene is then rendered by a camera. A single viewport can
contain multiple cameras, which could for example look at different locations of the same scene, or different scenes.</p>
<p>If the width and height are left undefined, the viewport becomes fullscreen.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> viewport = <span class="keyword">new</span> Engine.Viewport({
        width: <span class="number">500</span>,
        height: <span class="number">500</span>,
        background: <span class="string">'black'</span>,
        id: <span class="string">'engine'</span>
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>The camera actually renders the scene. For a Pong game it shouldn&#39;t be scrollable, or a user could drag away the game
using their mouse.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> camera = <span class="keyword">new</span> Engine.Camera({
        lookAt: scene,
        scrollable: <span class="literal">false</span>
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>After adding the camera to the viewport, the engine will actually already run. If you run the current code it would
only display a black screen though. <a href="http://jsfiddle.net/Solpeo/EDaV2/">See here</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    viewport.addCamera(camera);</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2>Draw Elements</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>-</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>We&#39;ll use a layout node to draw the visible elements on, because we would like to anchor the paddles and bars to the
outsides of the camera.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> layout = <span class="keyword">new</span> Engine.UI.Layout({
        fill: camera
    });

    scene.appendChild(layout);

    <span class="keyword">var</span> bars = {

        top: <span class="keyword">new</span> Engine.UI.Box({
            height: settings.barSize,
            fill: settings.color,
            stroke: settings.stroke,</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>By setting the anchors, the bar will always be the same width as the camera and be connected to the top of the camera.
This happens because &#39;parent&#39; in this case is &#39;layout&#39; (we&#39;ll add the bars to the layout after defining them), and
&#39;layout&#39; has been set to fill the camera. marginTop is used to leave some space between the top of the layout and the
top of the bar.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            anchors: {
                <span class="string">'fillwidth'</span>: <span class="string">'parent.fillwidth'</span>,
                <span class="string">'top'</span>: <span class="string">'parent.top'</span>
            },
            marginTop: settings.margin
        }),
        bottom: <span class="keyword">new</span> Engine.UI.Box({
            height: settings.barSize,
            fill: settings.color,
            stroke: settings.stroke,
            anchors: {
                <span class="string">'fillwidth'</span>: <span class="string">'parent.fillwidth'</span>,
                <span class="string">'bottom'</span>: <span class="string">'parent.bottom'</span>
            },
            marginBottom: settings.margin
        })

    };

    layout.appendChild(bars.top);
    layout.appendChild(bars.bottom);</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>The paddles are defined in the same way as the bars, but anchored to the left and right of the layout. We don&#39;t need to
set the top right now, because the motion code will handle that.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> paddles = {

        left: <span class="keyword">new</span> Engine.UI.Box({
            fill: settings.color,
            stroke: settings.stroke,
            width: settings.barSize,
            height: settings.paddleHeight,
            anchors: {
                <span class="string">'left'</span>: <span class="string">'parent.left'</span>
            },
            marginLeft: settings.margin
        }),
        right: <span class="keyword">new</span> Engine.UI.Box({
            fill: settings.color,
            stroke: settings.stroke,
            width: settings.barSize,
            height: settings.paddleHeight,
            anchors: {
                <span class="string">'right'</span>: <span class="string">'parent.right'</span>
            },
            marginRight: settings.margin
        })

    };

    layout.appendChild(paddles.left);
    layout.appendChild(paddles.right);</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Finally, the ball is added, again we don&#39;t need to bother with the position now, as the motion code will take care of
it. After drawing the game looks <a href="http://jsfiddle.net/Solpeo/wLbN3/">like this</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> ball = <span class="keyword">new</span> Engine.UI.Box({
        fill: settings.color,
        stroke: settings.stroke,
        width: settings.ballSize,
        height: settings.ballSize
    });

    layout.appendChild(ball);</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <h2>Game Logic</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>-</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>The core of the game is a timer, which will call its &#39;step&#39; event whenever a new frame is drawn.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> game = <span class="keyword">new</span> Engine.Timer({
        type: Engine.Timer.VSYNC,
        loop: <span class="literal">true</span>
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>To make the code a little easier to read, we&#39;ll create a quick helper to check if two boxes overlap. <code>UI.Box</code> objects
contain a <code>Geometry.Rectangle</code> as their <code>background</code>. This in turn has a <code>bb</code> (bounding box) which indicates it&#39;s
current on-scene position. Since we&#39;re building a 2D game made of only boxes, if they overlap, they&#39;re colliding.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="function"><span class="keyword">function</span> <span class="title">collide</span><span class="params">(box1, box2)</span>{</span>
        <span class="keyword">return</span> box1.background.bb.overlap(box2.background.bb);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>In JavaScript we can always add custom keys to object, so let&#39;s add the motion keys to the <code>UI.Box</code> objects that need
to be able to move. The ball in 2 dimensions, the paddles only in the vertical direction. The motion for the paddles is
used when keyboard control is being used. Then when the key is pressed it will be changed to the speed in that direction
and reset to 0 when the key is released.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    ball.motion = {
        x: settings.ballSpeed,
        y: settings.ballSpeed / <span class="number">2</span>
    };

    paddles.left.motion = <span class="number">0</span>;

    paddles.right.motion = <span class="number">0</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>When the game is controlled by the mouse, we should smooth the movement of the paddle a little. This function is also
used for the AI. The AI in this game seems quite unbeatable, to have some fun, you could try to make the game winnable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="function"><span class="keyword">function</span> <span class="title">elasticMove</span><span class="params">(paddle, desiredPosition, elasticity)</span>{</span>
        <span class="keyword">var</span> desiredTop = desiredPosition - <span class="number">0.5</span> * settings.paddleHeight;
        <span class="keyword">var</span> desiredChange = desiredTop - paddle.top;
        <span class="keyword">if</span> (desiredChange &lt; settings.minPaddleSpeed) <span class="keyword">return</span> movePaddle(paddle, desiredTop);
        <span class="keyword">if</span> (Math.abs(desiredChange) &gt; settings.maxPaddleSpeed)
            desiredChange = (desiredChange &gt; <span class="number">0</span>) ? settings.maxPaddleSpeed : -settings.maxPaddleSpeed;
        <span class="keyword">else</span>
            desiredChange = elasticity * desiredChange;

        <span class="keyword">return</span> movePaddle(paddle, paddle.top + desiredChange);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>The movePaddle function checks if the user (or AI) is trying to move the paddle beyond the bars, and positions it
correctly.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="function"><span class="keyword">function</span> <span class="title">movePaddle</span><span class="params">(paddle, top)</span>{</span></pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Helper function to move paddle, without going outside the bars</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        top = (top + settings.paddleHeight &gt; bars.bottom.top) ? bars.bottom.top - settings.paddleHeight : top;
        top = (top &lt; bars.top.bottom) ? bars.top.bottom : top;

        paddle.setPosition(paddle.left, top);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>The on <code>step</code> handler is called on each new frame, in most games it would hold the game loop logic. The timer&#39;s
stepprogress property indicates the amount of milliseconds that elapsed since the previous frame. This is used here
to make sure frame rate drops won&#39;t affect the movement speed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    game.on(<span class="string">'step'</span>, <span class="keyword">function</span>(){

        <span class="keyword">var</span> dt = <span class="keyword">this</span>.stepprogress / <span class="number">1000</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>First move the left paddle, which is always controlled by the user. Math.round is used to prevent the code from trying
to move the paddle partial pixels.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span>(settings.controls.type === controlOptions.KEYBOARD)
            movePaddle(paddles.left, paddles.left.top + Math.round(paddles.left.motion * dt));
        <span class="keyword">else</span> <span class="keyword">if</span> (settings.controls.type === controlOptions.MOUSE)
            elasticMove(paddles.left, settings.controls.mouseY, settings.playerElasticity);</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Now move the right paddle, which depending on the settings is player controlled or AI controlled. The AI will simply
track the ball using elastic move.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span>(settings.controls.type === controlOptions.KEYBOARD &amp;&amp; settings.multiplayer)
            movePaddle(paddles.right, paddles.right.top + Math.round(paddles.right.motion * dt));
        <span class="keyword">else</span> <span class="keyword">if</span> (!settings.multiplayer)
            <span class="keyword">if</span> (ball.motion.x &gt; <span class="number">0</span>) <span class="comment">/* Only move if the ball is moving to the right */</span>
                elasticMove(paddles.right, ball.top + <span class="number">0.5</span>* ball.height, settings.aiElasticity);</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>The ball is moved each step.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> left = ball.left + Math.round(ball.motion.x * dt);
        <span class="keyword">var</span> top = ball.top + Math.round(ball.motion.y * dt);
        ball.setPosition(left, top);</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>If the ball goes out of frame, the game is reset</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span>(ball.left &lt; <span class="number">0</span> || (ball.left + ball.width) &gt; layout.width)
            resetGame();</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>If the ball collides with either the bars or the paddles, its motion in one of its dimensions is reverted</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span>(collide(ball, bars.top))
            ball.motion.y = settings.ballSpeed / <span class="number">2</span>;
        <span class="keyword">if</span>(collide(ball, bars.bottom))
            ball.motion.y = -settings.ballSpeed / <span class="number">2</span>;
        <span class="keyword">if</span>(collide(ball, paddles.left))
            ball.motion.x = settings.ballSpeed;
        <span class="keyword">if</span>(collide(ball, paddles.right))
            ball.motion.x = -settings.ballSpeed;

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h2>Handling Keyboard Input</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>-</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>First, let&#39;s create a helper function to avoid having to write the <code>key</code> switch twice. The <code>direction</code> helper variable
makes sure that any change is reverted when the key is released.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="function"><span class="keyword">function</span> <span class="title">handleKey</span> <span class="params">(event, key)</span>{</span>
        <span class="keyword">var</span> direction = (event == <span class="string">'down'</span>) ? <span class="number">1</span> : -<span class="number">1</span>;
        <span class="keyword">switch</span>(key){
            <span class="keyword">case</span> settings.controls.leftUp:</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>When the motion is set, the game loop will start moving the paddle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                paddles.left.motion -= direction * settings.paddleSpeed;
                <span class="keyword">break</span>;
            <span class="keyword">case</span> settings.controls.leftDown:
                paddles.left.motion += direction * settings.paddleSpeed;
                <span class="keyword">break</span>;
            <span class="keyword">case</span> settings.controls.rightUp:
                <span class="keyword">if</span>(settings.multiplayer)
                    paddles.right.motion -= direction * settings.paddleSpeed;
                <span class="keyword">break</span>;
            <span class="keyword">case</span> settings.controls.rightDown:
                <span class="keyword">if</span>(settings.multiplayer)
                    paddles.right.motion += direction * settings.paddleSpeed;
                <span class="keyword">break</span>;
        }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Now catch the actual <code>keydown</code> and <code>keyup</code> by putting an event handler on <code>Engine.Input</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Engine.Input.on(<span class="string">'keydown'</span>, <span class="keyword">function</span>(e){
        <span class="keyword">if</span>(settings.controls.type === controlOptions.KEYBOARD)
            handleKey(<span class="string">'down'</span>, e.key);
    }).on(<span class="string">'keyup'</span>, <span class="keyword">function</span>(e){
        <span class="keyword">if</span>(settings.controls.type === controlOptions.KEYBOARD)
            handleKey(<span class="string">'up'</span>, e.key);</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>For mouse control we should store the position of the mouse when it changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    }).on(<span class="string">'mousemove'</span>, <span class="keyword">function</span>(e){
        <span class="keyword">if</span>(settings.controls.type !== controlOptions.MOUSE) <span class="keyword">return</span>;
        <span class="keyword">if</span>(e.cameraY &gt; bars.top.bottom &amp;&amp; e.cameraY &lt; bars.bottom.top)
            settings.controls.mouseY = e.cameraY;
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>When the ball goes out bounds, the ball should be placed in the middle of the field. It should then go towards the
player who just &#39;won&#39;, and randomly go up or down.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="function"><span class="keyword">function</span> <span class="title">resetGame</span><span class="params">()</span>{</span>
        ball.setPosition(layout.width / <span class="number">2</span>, layout.height / <span class="number">2</span>);
        ball.motion.x *= -<span class="number">1</span>;
        <span class="keyword">if</span>(Math.random() &gt; <span class="number">0.5</span>)
            ball.motion.y *= -<span class="number">1</span>;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Since <code>autoplay</code> is false on the game timer, we should call its <code>play</code> function manually. Let&#39;s also call resetGame
to start the game</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    game.play();
    resetGame();</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Move both paddles to get them in correct starting positions, the &#39;movePaddle&#39; function will make sure they won&#39;t remain
in a position which collides with the top or bottom bars.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    movePaddle(paddles.left, <span class="number">0</span>);
    movePaddle(paddles.right, <span class="number">0</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Finally, we need to close the <code>Engine.ready</code> handler. You can see the game running
<a href="http://jsfiddle.net/Solpeo/FJkAr/">here</a>. Please do keep in mind that the keyboard controls don&#39;t work in jsFiddle,
because jsFiddle captures the keyboard inputs before the Engine can.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
